# CRA Audit System Configuration for EU Cyber Resilience Act Compliance
# This file is sourced by the CRA audit services

# Foundries.io Factory Configuration
FACTORY="dynamic-devices"

# CRA Compliance Settings
COMPLIANCE_FRAMEWORK="EU_CRA"
AUDIT_RETENTION_DAYS="90"
LOG_RETENTION_DAYS="30"

# Event Classification Settings
CRITICAL_EVENTS="security_breach,unauthorized_access,system_compromise,cryptographic_failure"
HIGH_EVENTS="authentication_failure,service_failure,configuration_change,privilege_escalation"
MEDIUM_EVENTS="suspicious_activity,performance_degradation,resource_exhaustion"
LOW_EVENTS="information_disclosure,policy_violation,minor_configuration_change"

# Upload Settings
IMMEDIATE_UPLOAD="true"
QUEUE_WHEN_OFFLINE="true"
MAX_QUEUE_SIZE="100"
UPLOAD_TIMEOUT="30"

# Monitoring Settings
MONITOR_SYSTEM_LOGS="true"
MONITOR_SECURITY_EVENTS="true"
MONITOR_SERVICE_FAILURES="true"
MONITOR_AUTHENTICATION="true"

# Network Settings
CONNECTIVITY_CHECK_URL="https://ota-lite.foundries.io:8443"
CONNECTIVITY_CHECK_INTERVAL="60"

# Security Settings
VERIFY_SSL="true"
USE_DEVICE_CERTIFICATES="true"

# Logging Configuration
LOG_LEVEL="INFO"
LOG_FILE="/var/sota/logs/cra-audit-events.log"
SYSLOG_FACILITY="local0"

# Audit Storage Paths
AUDIT_QUEUE_DIR="/var/sota/audit-queue"
AUDIT_UPLOADED_DIR="/var/sota/audit-uploaded"

# Integration Settings
ENABLE_SYSTEMD_INTEGRATION="true"
ENABLE_AKTUALIZR_INTEGRATION="true"
ENABLE_SSH_MONITORING="true"

# Emergency Contact for Compliance Issues
COMPLIANCE_CONTACT="security@dynamicdevices.co.uk"
COMPLIANCE_PHONE="+44-XXX-XXXXXXX"

# Device Identification
# DEVICE_NAME will default to hostname if not set
# DEVICE_NAME="custom-device-name"

# Factory-specific Settings
# These can be overridden per factory deployment
DEVICE_GROUP="production"
DEVICE_TAG="cra-compliant"
